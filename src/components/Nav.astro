---
import NavIcon from './NavIcon.astro';

const currentPath = Astro.url.pathname;

const navLinks = [
  { href: '/investigations', label: 'Investigations', iconName: 'investigations' },
  { href: '/field-notes', label: 'Field Notes', iconName: 'field-notes' },
  { href: '/projects', label: 'Projects', iconName: 'projects' },
  { href: '/toolkit', label: 'Toolkit', iconName: 'toolkit' },
  { href: '/shelf', label: 'Shelf', iconName: 'shelf' },
  { href: '/colophon', label: 'Colophon', iconName: 'colophon' },
  { href: '/connect', label: 'Connect', iconName: 'connect' },
];

function isActive(href: string): boolean {
  if (href === '/') return currentPath === '/';
  return currentPath.startsWith(href);
}
---

<nav class="sticky top-0 z-50 bg-paper/95 backdrop-blur-sm border-b border-border">
  <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
    <!-- Site title -->
    <a href="/" class="text-xl text-ink no-underline hover:text-terracotta transition-colors" style="font-family: var(--font-name); font-weight: 400;">
      Travis Gilbert
    </a>

    <!-- Desktop nav -->
    <ul class="hidden md:flex items-center gap-6 list-none m-0 p-0">
      {navLinks.map((link) => (
        <li>
          <a
            href={link.href}
            class:list={[
              'font-mono text-xs uppercase tracking-widest no-underline transition-colors inline-flex items-center gap-1.5',
              isActive(link.href)
                ? 'text-terracotta font-bold'
                : 'text-ink-secondary hover:text-terracotta',
            ]}
          >
            <NavIcon name={link.iconName} class="w-4 h-4" />
            {link.label}
          </a>
        </li>
      ))}
    </ul>

    <!-- Mobile hamburger -->
    <button
      id="mobile-menu-toggle"
      class="md:hidden flex flex-col gap-1.5 p-2 bg-transparent border-none cursor-pointer"
      aria-label="Toggle navigation menu"
      aria-expanded="false"
    >
      <span class="block w-5 h-0.5 bg-ink transition-transform" />
      <span class="block w-5 h-0.5 bg-ink transition-opacity" />
      <span class="block w-5 h-0.5 bg-ink transition-transform" />
    </button>
  </div>

  <!-- Mobile menu panel -->
  <div
    id="mobile-menu"
    class="hidden md:hidden bg-paper border-t border-border"
  >
    <ul class="list-none m-0 p-4 flex flex-col gap-3">
      {navLinks.map((link) => (
        <li>
          <a
            href={link.href}
            class:list={[
              'font-mono text-sm uppercase tracking-widest no-underline py-1 inline-flex items-center gap-2',
              isActive(link.href)
                ? 'text-terracotta font-bold'
                : 'text-ink-secondary hover:text-terracotta',
            ]}
          >
            <NavIcon name={link.iconName} class="w-4 h-4" />
            {link.label}
          </a>
        </li>
      ))}
    </ul>
  </div>
</nav>

<script>
  const toggle = document.getElementById('mobile-menu-toggle');
  const menu = document.getElementById('mobile-menu');

  toggle?.addEventListener('click', () => {
    const expanded = toggle.getAttribute('aria-expanded') === 'true';
    toggle.setAttribute('aria-expanded', String(!expanded));
    menu?.classList.toggle('hidden');
  });
</script>

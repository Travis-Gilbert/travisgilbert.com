{% extends "base.html" %}

{% block title %}Publish Log{% endblock %}

{% block content %}
<div class="content-list-page">
    <div class="list-header">
        <h1>Publish Log</h1>
    </div>

    {% if logs %}
    <table class="content-table">
        <thead>
            <tr>
                <th>Date</th>
                <th>Type</th>
                <th>Slug</th>
                <th>Status</th>
                <th>Commit</th>
            </tr>
        </thead>
        <tbody>
            {% for log in logs %}
            <tr class="{% if log.success %}publish-success{% else %}publish-fail{% endif %}">
                <td class="col-date">{{ log.created_at|date:"M j, Y g:i A" }}</td>
                <td>{{ log.content_type }}</td>
                <td>{{ log.content_slug }}</td>
                <td>{% if log.success %}OK{% else %}FAILED{% endif %}</td>
                <td>
                    {% if log.commit_url %}
                    <a href="{{ log.commit_url }}" target="_blank" rel="noopener">
                        {{ log.commit_sha|truncatechars:7 }}
                    </a>
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    {% if page_obj.has_other_pages %}
    <nav class="pagination">
        {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}" class="btn btn-sm">&larr; Newer</a>
        {% endif %}
        <span class="page-info">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span>
        {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}" class="btn btn-sm">Older &rarr;</a>
        {% endif %}
    </nav>
    {% endif %}

    {% else %}
    <p class="empty-state">No publish events recorded yet.</p>
    {% endif %}
</div>
{% endblock %}
